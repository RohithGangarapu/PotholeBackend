# Pothole Detection System - Complete Testing Demo Guide

## ðŸ“½ï¸ Demo Video & Frame Processing Flow

This document provides a complete walkthrough of the pothole detection system with detailed flow diagrams, step-by-step testing procedures, and expected outputs.

---

## ðŸ”„ Complete Detection Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        VIDEO STREAMING & DETECTION FLOW                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   USER/API   â”‚         â”‚   DJANGO SERVER   â”‚         â”‚   EXTERNAL SERVICES  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                         â”‚                              â”‚
           â”‚  1. POST /video-stream/ â”‚                              â”‚
           â”‚  {stream_id, video_url, â”‚                              â”‚
           â”‚   device_id, frame_interval}                           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
                                    â”‚                              â”‚
                                    â–¼                              â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                           â”‚ VideoStreamView â”‚                    â”‚
                           â”‚     .post()     â”‚                    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                    â”‚                              â”‚
                                    â–¼                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
                    â”‚ VideoStreamProcessor           â”‚            â”‚
                    â”‚ â€¢ Opens CV2 VideoCapture       â”‚            â”‚
                    â”‚ â€¢ Starts capture thread        â”‚            â”‚
                    â”‚ â€¢ frame_interval = 30s (default)           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                                     â”‚                            â”‚
                                     â”‚ [Background Thread]        â”‚
                                     â–¼                            â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                           â”‚  _capture_framesâ”‚                    â”‚
                           â”‚     loop        â”‚                    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                    â”‚                             â”‚
                                    â”‚ Every frame_interval secondsâ”‚
                                    â–¼                             â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                           â”‚ cv2.read(frame) â”‚                    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                    â”‚                             â”‚
                                    â–¼                             â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                           â”‚ _send_frame_to_ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
                           â”‚    detection()  â”‚  POST /potholes/    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   upload-image/     â”‚
                                                                  â”‚
                                                                  â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚    PotholeDetector      â”‚
                                                   â”‚ (Hugging Face Space)    â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ 1. Upload frame
                                                               â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚  _upload_file()         â”‚
                                                   â”‚  â†’ RohithGangarapu/     â”‚
                                                   â”‚    PotholeYoloV8-NEW    â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ 2. Create inference
                                                               â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚  POST /gradio_api/call/ â”‚
                                                   â”‚  predict                â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ 3. Poll for result
                                                               â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚  SSE stream             â”‚
                                                   â”‚  â€¢ event: complete      â”‚
                                                   â”‚  â€¢ data: [bbox, conf]   â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ 4. Return detections
                                                               â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚ Process results:        â”‚
                                                   â”‚ â€¢ Calculate depth       â”‚
                                                   â”‚ â€¢ Determine severity    â”‚
                                                   â”‚ â€¢ Draw bounding boxes   â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ Save potholes   â”‚
                           â”‚ to database     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ Pothole Model   â”‚
                           â”‚ â€¢ depth         â”‚
                           â”‚ â€¢ severity      â”‚
                           â”‚ â€¢ image         â”‚
                           â”‚ â€¢ coordinates   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š Frame Processing Sequence Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRAME PROCESSING SEQUENCE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Time â”€â”€â–º
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Thread â”‚    â”‚ Processor â”‚    â”‚ VideoCapture â”‚    â”‚   Detector  â”‚    â”‚  DB     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚ start()      â”‚                 â”‚                   â”‚               â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ cap.open(url)   â”‚                   â”‚               â”‚
         â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ loop start      â”‚                   â”‚               â”‚
         â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚   read frame    â”‚                   â”‚               â”‚
         â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚   is_interval?  â”‚                   â”‚               â”‚
         â”‚              â”‚ (30s elapsed)   â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ send_to_api()   â”‚                   â”‚               â”‚
         â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚   upload_file()   â”‚               â”‚
         â”‚              â”‚                 â”‚   (HTTP POST)     â”‚               â”‚
         â”‚              â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚   create_task()   â”‚               â”‚
         â”‚              â”‚                 â”‚   (HTTP POST)     â”‚               â”‚
         â”‚              â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚   poll_sse()      â”‚               â”‚
         â”‚              â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚   return result â”‚                   â”‚               â”‚
         â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ parse_results() â”‚                   â”‚               â”‚
         â”‚              â”‚ (bboxes, depth) â”‚                   â”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ save_pothole()  â”‚                   â”‚               â”‚
         â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
         â”‚              â”‚ sleep(0.1s)     â”‚                   â”‚               â”‚
         â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
         â”‚              â”‚                 â”‚                   â”‚               â”‚
```

---

## ðŸŽ¬ Step-by-Step Demo Testing Procedure

### Phase 1: Start the Django Server

```bash
cd /Users/rohith/Desktop/PotholeDetection/backend
python manage.py runserver
```

**Expected Output:**
```
Watching for file changes with 'StatReloader'
January XX, 202X - XX:XX:XX
Django version X.X, using settings 'backend.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
```

---

### Phase 2: Start Video Stream

```bash
curl -X POST http://localhost:8000/api/v1/video-stream/ \
  -H "Content-Type: application/json" \
  -d '{
    "stream_id": "demo_stream_1",
    "video_url": "https://commondatastorage.googleapis.com/gtv-videos-library/sample/BigBuckBunny.mp4",
    "device_id": 1,
    "frame_interval": 10
  }'
```

**Expected Response:**
```json
{
  "status": "success",
  "message": "Video streaming started for stream demo_stream_1",
  "stream_id": "demo_stream_1"
}
```

---

### Phase 3: Monitor Stream Progress

```bash
# Terminal 1: Check stream status
curl "http://localhost:8000/api/v1/video-stream/status/?stream_id=demo_stream_1"

# Terminal 2: Check frame queue
curl http://localhost:8000/api/v1/frame-processing/
```

**Expected Status Response:**
```json
{
  "status": "success",
  "data": {
    "is_running": true,
    "video_url": "https://commondatastorage.googleapis.com/gtv-videos-library/sample/BigBuckBunny.mp4",
    "frame_interval": 10,
    "device_id": 1,
    "connection_active": true,
    "frames_processed": 5,
    "frames_sent": 4,
    "frames_failed": 0
  }
}
```

**Expected Queue Response:**
```json
{
  "status": "success",
  "data": {
    "queue_size": 0,
    "total_tasks": 10,
    "completed_tasks": 10,
    "failed_tasks": 0,
    "pending_tasks": 0,
    "running_tasks": 0,
    "active_workers": 2
  }
}
```

---

### Phase 4: Check Detected Potholes

```bash
# Get all potholes
curl http://localhost:8000/api/v1/potholes/

# Get potholes by device
curl http://localhost:8000/api/v1/potholes/by-device/1/

# Get high severity potholes
curl http://localhost:8000/api/v1/potholes/by-severity/high/
```

**Expected Pothole Response:**
```json
{
  "status": "success",
  "data": [
    {
      "id": 1,
      "device": 1,
      "user": null,
      "depth": 8.5,
      "severity": "medium",
      "image": "http://localhost:8000/media/potholes/annotated_abc123.jpg",
      "latitude": 40.7128,
      "longitude": -74.0060,
      "status": "unresolved",
      "created_at": "2024-01-28T10:30:00Z"
    }
  ]
}
```

---

### Phase 5: Stop the Stream

```bash
curl -X DELETE http://localhost:8000/api/v1/video-stream/demo_stream_1/
```

**Expected Response:**
```json
{
  "status": "success",
  "message": "Video streaming stopped for stream demo_stream_1"
}
```

---

## ðŸ”§ Automated Demo Script

Run the automated demo:

```bash
cd /Users/rohith/Desktop/PotholeDetection/backend
python demo_video_stream.py
```

**What the script does:**
1. Presents available demo videos
2. Starts video streaming
3. Monitors progress for 30 seconds
4. Displays detection results
5. Stops the stream automatically

---

## ðŸ“ˆ Detection Flow State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DETECTION STATE MACHINE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         IDLE (No Stream)            â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ Waiting for POST request    â”‚   â”‚
                    â”‚  â”‚ to /api/v1/video-stream/    â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           POST /video-stream/
                           {stream_id, video_url}
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      STREAM_STARTING                â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ â€¢ Create VideoCapture       â”‚   â”‚
                    â”‚  â”‚ â€¢ Start capture thread      â”‚   â”‚
                    â”‚  â”‚ â€¢ Initialize detector       â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           Thread started
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        CAPTURING                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ while is_running:           â”‚   â”‚
                    â”‚  â”‚   read frame                â”‚   â”‚
                    â”‚  â”‚   check interval            â”‚   â”‚
                    â”‚  â”‚   send to detection         â”‚   â”‚
                    â”‚  â”‚   sleep(0.1)                â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           DELETE /video-stream/{id}/
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        STOPPING                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ â€¢ Set is_running = False    â”‚   â”‚
                    â”‚  â”‚ â€¢ Stop capture thread       â”‚   â”‚
                    â”‚  â”‚ â€¢ Release CV2 resources     â”‚   â”‚
                    â”‚  â”‚ â€¢ Cleanup                   â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           Resources released
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         IDLE                        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š Detection Queue Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRAME QUEUE PROCESSING FLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         FrameQueue (2 workers)                          â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                         â”‚
    â”‚   [Task Queue]              [Worker 1]              [Result Store]     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚ Task 1  â”‚â”€â”€â”€â”€â”€â”€â”€â”       â”‚         â”‚               â”‚ Task 1      â”‚  â”‚
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚       â”‚ Working â”‚               â”‚ status: OK  â”‚  â”‚
    â”‚   â”‚ Task 2  â”‚       â”œâ”€â”€â”€â”€â”€â”€â–ºâ”‚         â”‚               â”‚ result: {...}â”‚ â”‚
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚   â”‚ Task 3  â”‚       â”‚               â”‚                                    â”‚
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚               â”‚                                    â”‚
    â”‚   â”‚ Task 4  â”‚       â”‚               â”‚                                    â”‚
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚               â”‚                                    â”‚
    â”‚   â”‚ Task 5  â”‚       â”‚               â”‚                                    â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚               â”‚                                    â”‚
    â”‚                     â”‚               â”‚                                    â”‚
    â”‚                     â”‚               â”‚                                    â”‚
    â”‚                     â”‚               â–¼                                    â”‚
    â”‚                     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
    â”‚                     â”‚       â”‚ Worker 2â”‚                                 â”‚
    â”‚                     â””â”€â”€â”€â”€â”€â”€â–ºâ”‚         â”‚                                 â”‚
    â”‚                             â”‚ Working â”‚                                 â”‚
    â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
    â”‚                                                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           queue.get() / queue.task_done()
                                    â”‚
                                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         Task Lifecycle                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                         â”‚
    â”‚   PENDING â”€â”€â–º RUNNING â”€â”€â–º COMPLETED                                    â”‚
    â”‚      â”‚          â”‚          â”‚                                            â”‚
    â”‚      â”‚          â”‚          â””â”€â”€â–º Saved to result_store                   â”‚
    â”‚      â”‚          â”‚                                                      â”‚
    â”‚      â”‚          â””â”€â”€â–º Error: FAILED                                     â”‚
    â”‚      â”‚                                                              â”‚
    â”‚      â””â”€â”€â–º Added to task_queue                                         â”‚
    â”‚                                                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ¯ Severity Calculation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SEVERITY CALCULATION ALGORITHM                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Detection bbox [x1,y1, â”‚
                    â”‚           x2,y2,conf,   â”‚
                    â”‚           class_id]     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Calculate relative area â”‚
                    â”‚ rel_area = (x2-x1)*(y2-y1)â”‚
                    â”‚             / (h*w)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Calculate depth         â”‚
                    â”‚ depth = rel_area * 50   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚                 â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ depth > 15cm    â”‚ â”‚ 5cm < depth â”‚ â”‚ depth <= 5cm  â”‚
     â”‚                 â”‚ â”‚ <= 15cm     â”‚ â”‚               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          HIGH               MEDIUM            LOW
              â”‚                 â”‚                 â”‚
              â–¼                 â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Color: RED      â”‚ â”‚ Color: ORANGE â”‚ â”‚ Color: GREEN  â”‚
    â”‚ (0, 0, 255)     â”‚ â”‚ (0, 165, 255) â”‚ â”‚ (0, 255, 0)   â”‚
    â”‚                 â”‚ â”‚               â”‚ â”‚               â”‚
    â”‚ Priority:       â”‚ â”‚ Priority:     â”‚ â”‚ Priority:     â”‚
    â”‚ CRITICAL        â”‚ â”‚ NORMAL        â”‚ â”‚ LOW           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ File Processing Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FILE PROCESSING WORKFLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Input Frame  â”‚â”€â”€â”€â”€â–ºâ”‚ Temp Storage â”‚â”€â”€â”€â”€â–ºâ”‚ Detection    â”‚â”€â”€â”€â”€â–ºâ”‚ Database â”‚
    â”‚ (from video) â”‚     â”‚ (tmp/)       â”‚     â”‚ (HuggingFace)â”‚     â”‚ (Pothole)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                   â”‚                    â”‚                   â”‚
           â”‚                   â”‚                    â”‚                   â”‚
           â–¼                   â–¼                    â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â€¢ CV2 read   â”‚     â”‚ â€¢ Django     â”‚     â”‚ â€¢ Upload     â”‚     â”‚ â€¢ depth  â”‚
    â”‚ â€¢ JPEG       â”‚     â”‚   default_   â”‚     â”‚   file       â”‚     â”‚ â€¢ severityâ”‚
    â”‚   encoding   â”‚     â”‚   storage    â”‚     â”‚ â€¢ API call   â”‚     â”‚ â€¢ image  â”‚
    â”‚ â€¢ BytesIO    â”‚     â”‚ â€¢ Save temp  â”‚     â”‚ â€¢ SSE poll   â”‚     â”‚ â€¢ coords â”‚
    â”‚   convert    â”‚     â”‚ â€¢ Path gen   â”‚     â”‚ â€¢ Parse JSON â”‚     â”‚ â€¢ status â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                   â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ Annotated Image  â”‚
                           â”‚ (with bboxes)    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ media/potholes/  â”‚
                           â”‚ annotated_*.jpg  â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ§ª Testing Checklist

### Pre-requisites
- [ ] Django server is running
- [ ] Internet connection (for Hugging Face API)
- [ ] Demo video URL is accessible

### Functional Tests
- [ ] Start video stream with valid URL
- [ ] Start video stream with invalid URL (expect error)
- [ ] Monitor stream status during processing
- [ ] Check frame queue statistics
- [ ] Verify potholes are created after detection
- [ ] Filter potholes by severity
- [ ] Filter potholes by device
- [ ] Stop stream successfully
- [ ] Stop non-existent stream (expect 404)

### Performance Tests
- [ ] Process 100+ frames
- [ ] Verify no memory leaks
- [ ] Check CPU usage during streaming
- [ ] Test with different frame intervals

---

## ðŸš¨ Troubleshooting Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TROUBLESHOOTING GUIDE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Problem: Stream won't start
    â”‚
    â”œâ”€â”€ Check: Is Django server running?
    â”‚   â””â”€â”€ Fix: python manage.py runserver
    â”‚
    â”œâ”€â”€ Check: Is video URL valid?
    â”‚   â””â”€â”€ Fix: Test URL in browser/VLC
    â”‚
    â””â”€â”€ Check: Is stream_id unique?
        â””â”€â”€ Fix: Use different stream_id

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Problem: No frames being processed
    â”‚
    â”œâ”€â”€ Check: Is connection_active = true?
    â”‚   â””â”€â”€ Fix: Check video URL and network
    â”‚
    â”œâ”€â”€ Check: Is frames_processed increasing?
    â”‚   â””â”€â”€ Fix: Wait for frame_interval seconds
    â”‚
    â””â”€â”€ Check: Are workers active?
        â””â”€â”€ Fix: Check /api/v1/frame-processing/

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Problem: Detection failing
    â”‚
    â”œâ”€â”€ Check: Is Hugging Face Space accessible?
    â”‚   â””â”€â”€ Fix: Open https://rohithgangarapu-potholeyolov8-new.hf.space
    â”‚
    â”œâ”€â”€ Check: Are uploads timing out?
    â”‚   â””â”€â”€ Fix: Increase timeout in detector.py
    â”‚
    â””â”€â”€ Check: Are frames valid images?
        â””â”€â”€ Fix: Verify cv2.imread works

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Problem: High memory usage
    â”‚
    â”œâ”€â”€ Check: Are temp files being cleaned?
    â”‚   â””â”€â”€ Fix: Verify cleanup in finally block
    â”‚
    â””â”€â”€ Check: Are annotated images saved?
        â””â”€â”€ Fix: Check media/potholes/ directory
```

---

## ðŸ“ž Quick Test Commands

```bash
# 1. Start stream
curl -X POST http://localhost:8000/api/v1/video-stream/ \
  -H "Content-Type: application/json" \
  -d '{"stream_id":"test1","video_url":"https://www.w3schools.com/html/mov_bbb.mp4","device_id":1,"frame_interval":30}'

# 2. Check status (wait 30s between checks)
curl "http://localhost:8000/api/v1/video-stream/status/?stream_id=test1"

# 3. Check queue
curl http://localhost:8000/api/v1/frame-processing/

# 4. View potholes
curl http://localhost:8000/api/v1/potholes/

# 5. Stop stream
curl -X DELETE http://localhost:8000/api/v1/video-stream/test1/
```

---

## ðŸŽ¬ Video Demo Script Output Example

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ðŸŽ¬ VIDEO STREAMING DEMO ðŸŽ¬                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“¹ Available Demo Videos:
   1. sample_video
   2. test_video
   3. nature

âœ¨ Using: https://commondatastorage.googleapis.com/gtv-videos-library/sample/BigBuckBunny.mp4

============================================================
ðŸŽ¬ Starting Demo Video Stream
============================================================
Stream ID: demo_sample_video
Video URL: https://commondatastorage.googleapis.com/gtv-videos-library/sample/BigBuckBunny.mp4
Frame Interval: 10s

âœ… Success: Video streaming started for stream demo_sample_video

============================================================
ðŸ“Š Monitoring Stream (for 30 seconds)
============================================================

â±ï¸  [1s] ðŸŽ¥ 0 frames processed âœ… 0 sent âŒ 0 failed âš™ï¸ 2 workers ðŸ“¦ Q:0
â±ï¸  [2s] ðŸŽ¥ 0 frames processed âœ… 0 sent âŒ 0 failed âš™ï¸ 2 workers ðŸ“¦ Q:0
â±ï¸  [10s] ðŸŽ¥ 1 frames processed âœ… 1 sent âŒ 0 failed âš™ï¸ 2 workers ðŸ“¦ Q:0
â±ï¸  [20s] ðŸŽ¥ 2 frames processed âœ… 2 sent âŒ 0 failed âš™ï¸ 2 workers ðŸ“¦ Q:0
â±ï¸  [30s] ðŸŽ¥ 3 frames processed âœ… 3 sent âŒ 0 failed âš™ï¸ 2 workers ðŸ“¦ Q:0

============================================================
ðŸ“‹ Detection Results
============================================================

âœ… Streaming Statistics:
   Total Frames Processed: 3
   Frames Sent to Detection: 3
   Failed Frames: 0
   Success Rate: 100.0%

ðŸ•³ï¸  Detected Potholes:
   Found 0 pothole(s):
   No potholes detected in this demo

============================================================
ðŸ›‘ Stopping Stream
============================================================

âœ… Stream stopped successfully

============================================================
âœ… Demo Complete!
============================================================

ðŸ“Š View more details at:
   â€¢ http://localhost:8000/api/v1/docs/
   â€¢ http://localhost:8000/api/v1/potholes/
```

---

## ðŸ”— API Endpoints Summary

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/v1/video-stream/` | Start video streaming |
| DELETE | `/api/v1/video-stream/{id}/` | Stop video streaming |
| GET | `/api/v1/video-stream/status/` | Get stream status |
| GET | `/api/v1/frame-processing/` | Get queue statistics |
| POST | `/api/v1/potholes/upload-image/` | Upload image for detection |
| GET | `/api/v1/potholes/` | List all potholes |
| GET | `/api/v1/potholes/by-device/{id}/` | Get potholes by device |
| GET | `/api/v1/potholes/by-severity/{level}/` | Get by severity |
| GET | `/api/v1/potholes/by-status/{status}/` | Get by status |

---

*Document generated for Pothole Detection System - Backend API*
*Last updated: 2024*

